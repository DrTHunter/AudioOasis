<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lo-Fi Vibes</title>
    <style>
        /* CSS Styles */
        body {
            font-family: 'Arial', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }

        header {
            background-color: #2c3e50;
            color: white;
            padding: 1rem;
            text-align: center;
        }

        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-btn {
            background-color: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            cursor: pointer;
            font-size: 16px;
            border-radius: 4px;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #f9f9f9;
            min-width: 160px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 4px;
        }

        .dropdown-content a {
            color: black;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
        }

        .dropdown-content a:hover {
            background-color: #f1f1f1;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }

        .music-player {
            max-width: 800px;
            margin: 2rem auto;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }

        .player-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
            flex-wrap: wrap;
        }

        .player-controls button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            min-width: 80px;
        }

        .player-controls button:hover {
            background-color: #2980b9;
        }

        .track-info {
            text-align: center;
            margin: 15px 0;
        }

        .playlist {
            margin-top: 20px;
            max-height: 400px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 4px;
        }

        .playlist-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            display: flex;
            align-items: center;
            user-select: none;
        }

        .playlist-item:hover {
            background-color: #f5f5f5;
        }

        .playlist-item.active {
            background-color: #e1f5fe;
            font-weight: bold;
        }

        .playlist-item .drag-handle {
            cursor: move;
            margin-right: 10px;
            color: #777;
        }

        progress {
            width: 100%;
            height: 5px;
            margin-top: 10px;
        }

        .loop-controls {
            display: flex;
            justify-content: center;
            margin: 15px 0;
        }

        .loop-controls button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 8px 15px;
            margin: 0 5px;
            border-radius: 4px;
            cursor: pointer;
        }

        .loop-controls button.active {
            background-color: #2ecc71;
        }

        .track-number {
            margin-right: 10px;
            color: #777;
            width: 25px;
            text-align: right;
        }

        .track-info-container {
            display: flex;
            flex-grow: 1;
            align-items: center;
        }
    </style>
</head>
<body>
    <header>
        <h1>Lo-Fi Vibes</h1>
        <div class="dropdown">
            <button class="dropdown-btn">Menu</button>
            <div class="dropdown-content">
                <a href="#">Home</a>
                <a href="#music-player">Music Player</a>
                <a href="#">About</a>
                <a href="#">Contact</a>
            </div>
        </div>
    </header>

    <div class="music-player" id="music-player">
        <h2>Music Player</h2>
        <div class="track-info">
            <h3 id="current-track">Select a track</h3>
            <div id="time-display">0:00 / 0:00</div>
        </div>
        <audio id="audio-player"></audio>
        <progress id="progress-bar" value="0" max="100"></progress>
        
        <div class="loop-controls">
            <button id="loop-none" class="active">No Loop</button>
            <button id="loop-one">Loop Track</button>
            <button id="loop-all">Loop Playlist</button>
        </div>
        
        <div class="player-controls">
            <button id="prev-btn">Previous</button>
            <button id="play-btn">Play</button>
            <button id="pause-btn">Pause</button>
            <button id="next-btn">Next</button>
            <button id="shuffle-btn">Shuffle</button>
        </div>
        
        <div class="playlist" id="playlist">
            <!-- Playlist items will be generated by JavaScript -->
        </div>
    </div>

    <script>
        // JavaScript for the music player
        document.addEventListener('DOMContentLoaded', function() {
            const audioPlayer = document.getElementById('audio-player');
            const playBtn = document.getElementById('play-btn');
            const pauseBtn = document.getElementById('pause-btn');
            const prevBtn = document.getElementById('prev-btn');
            const nextBtn = document.getElementById('next-btn');
            const shuffleBtn = document.getElementById('shuffle-btn');
            const progressBar = document.getElementById('progress-bar');
            const currentTrackDisplay = document.getElementById('current-track');
            const timeDisplay = document.getElementById('time-display');
            const playlistElement = document.getElementById('playlist');
            const loopNoneBtn = document.getElementById('loop-none');
            const loopOneBtn = document.getElementById('loop-one');
            const loopAllBtn = document.getElementById('loop-all');
            
            let currentTrackIndex = 0;
            let isPlaying = false;
            let loopMode = 'none'; // 'none', 'one', 'all'
            let isDragging = false;
            let draggedItem = null;
            let originalPlaylistOrder = [];

            // Sample tracks - replace with your actual tracks
            const tracks = [];
            for (let i = 1; i <= 35; i++) {
                tracks.push({
                    title: `Lo-Fi Track ${i}`,
                    src: `lofi${i % 4 + 1}.${i % 2 === 0 ? 'wav' : 'mp3'}`,
                    duration: `${Math.floor(Math.random() * 3) + 2}:${Math.floor(Math.random() * 60).toString().padStart(2, '0')}`
                });
            }

            // Initialize playlist
            function initializePlaylist() {
                playlistElement.innerHTML = '';
                tracks.forEach((track, index) => {
                    const item = document.createElement('div');
                    item.className = 'playlist-item';
                    item.setAttribute('data-index', index);
                    item.setAttribute('draggable', 'true');
                    
                    item.innerHTML = `
                        <div class="track-number">${index + 1}</div>
                        <span class="drag-handle">â˜°</span>
                        <div class="track-info-container">
                            <span>${track.title}</span>
                            <span style="margin-left: auto; color: #777;">${track.duration}</span>
                        </div>
                    `;
                    
                    item.addEventListener('click', function() {
                        currentTrackIndex = index;
                        loadTrack(currentTrackIndex);
                        playTrack();
                    });
                    
                    // Drag and drop events
                    item.addEventListener('dragstart', function(e) {
                        draggedItem = item;
                        e.dataTransfer.effectAllowed = 'move';
                        e.dataTransfer.setData('text/html', item.innerHTML);
                        item.style.opacity = '0.4';
                    });
                    
                    item.addEventListener('dragover', function(e) {
                        e.preventDefault();
                        e.dataTransfer.dropEffect = 'move';
                        const target = e.target.closest('.playlist-item');
                        if (target && target !== draggedItem) {
                            const rect = target.getBoundingClientRect();
                            const midpoint = rect.top + rect.height / 2;
                            if (e.clientY < midpoint) {
                                playlistElement.insertBefore(draggedItem, target);
                            } else {
                                playlistElement.insertBefore(draggedItem, target.nextSibling);
                            }
                        }
                    });
                    
                    item.addEventListener('dragend', function() {
                        item.style.opacity = '1';
                        updateTrackOrder();
                    });
                    
                    playlistElement.appendChild(item);
                });
                originalPlaylistOrder = [...tracks];
            }

            function updateTrackOrder() {
                const items = playlistElement.querySelectorAll('.playlist-item');
                items.forEach((item, index) => {
                    const originalIndex = parseInt(item.getAttribute('data-index'));
                    item.querySelector('.track-number').textContent = index + 1;
                    
                    // Update the track order in the tracks array
                    if (originalIndex !== index) {
                        const [movedTrack] = tracks.splice(originalIndex, 1);
                        tracks.splice(index, 0, movedTrack);
                        
                        // Update all data-index attributes
                        playlistElement.querySelectorAll('.playlist-item').forEach((el, i) => {
                            el.setAttribute('data-index', i);
                        });
                        
                        // If the current track was moved, update its index
                        if (currentTrackIndex === originalIndex) {
                            currentTrackIndex = index;
                        } else if (currentTrackIndex > originalIndex && currentTrackIndex <= index) {
                            currentTrackIndex--;
                        } else if (currentTrackIndex < originalIndex && currentTrackIndex >= index) {
                            currentTrackIndex++;
                        }
                    }
                });
            }

            function loadTrack(index) {
                if (index < 0 || index >= tracks.length) return;
                
                audioPlayer.src = tracks[index].src;
                currentTrackDisplay.textContent = tracks[index].title;
                
                // Update active playlist item
                const items = playlistElement.querySelectorAll('.playlist-item');
                items.forEach(item => item.classList.remove('active'));
                items[index].classList.add('active');
                
                // Scroll to the active item
                items[index].scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            }

            function playTrack() {
                audioPlayer.play()
                    .then(() => {
                        isPlaying = true;
                        playBtn.textContent = "Playing";
                    })
                    .catch(error => {
                        console.error("Playback failed:", error);
                    });
            }

            function pauseTrack() {
                audioPlayer.pause();
                isPlaying = false;
                playBtn.textContent = "Play";
            }

            function nextTrack() {
                if (loopMode === 'one') {
                    audioPlayer.currentTime = 0;
                    audioPlayer.play();
                    return;
                }
                
                if (currentTrackIndex < tracks.length - 1) {
                    currentTrackIndex++;
                } else {
                    if (loopMode === 'all') {
                        currentTrackIndex = 0;
                    } else {
                        pauseTrack();
                        return;
                    }
                }
                loadTrack(currentTrackIndex);
                if (isPlaying) playTrack();
            }

            function prevTrack() {
                if (audioPlayer.currentTime > 3) {
                    // If more than 3 seconds into the track, restart it
                    audioPlayer.currentTime = 0;
                } else {
                    // Otherwise go to previous track
                    if (currentTrackIndex > 0) {
                        currentTrackIndex--;
                    } else {
                        if (loopMode === 'all') {
                            currentTrackIndex = tracks.length - 1;
                        } else {
                            currentTrackIndex = 0;
                        }
                    }
                    loadTrack(currentTrackIndex);
                }
                if (isPlaying) playTrack();
            }

            function shufflePlaylist() {
                // Save the current track
                const currentTrack = tracks[currentTrackIndex];
                
                // Shuffle the array (Fisher-Yates algorithm)
                for (let i = tracks.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [tracks[i], tracks[j]] = [tracks[j], tracks[i]];
                }
                
                // Find the new position of the current track
                currentTrackIndex = tracks.indexOf(currentTrack);
                
                // Rebuild the playlist
                initializePlaylist();
                loadTrack(currentTrackIndex);
            }

            function formatTime(seconds) {
                const mins = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${mins}:${secs < 10 ? '0' : ''}${secs}`;
            }

            // Event listeners
            playBtn.addEventListener('click', playTrack);
            pauseBtn.addEventListener('click', pauseTrack);
            nextBtn.addEventListener('click', nextTrack);
            prevBtn.addEventListener('click', prevTrack);
            shuffleBtn.addEventListener('click', shufflePlaylist);

            audioPlayer.addEventListener('timeupdate', function() {
                const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
                progressBar.value = isNaN(progress) ? 0 : progress;
                
                // Update time display
                if (audioPlayer.duration) {
                    timeDisplay.textContent = `${formatTime(audioPlayer.currentTime)} / ${formatTime(audioPlayer.duration)}`;
                }
            });

            progressBar.addEventListener('click', function(e) {
                const percent = e.offsetX / this.offsetWidth;
                audioPlayer.currentTime = percent * audioPlayer.duration;
            });

            audioPlayer.addEventListener('ended', function() {
                if (loopMode === 'one') {
                    audioPlayer.currentTime = 0;
                    audioPlayer.play();
                } else {
                    nextTrack();
                }
            });

            // Loop mode controls
            loopNoneBtn.addEventListener('click', function() {
                loopMode = 'none';
                loopNoneBtn.classList.add('active');
                loopOneBtn.classList.remove('active');
                loopAllBtn.classList.remove('active');
                audioPlayer.loop = false;
            });

            loopOneBtn.addEventListener('click', function() {
                loopMode = 'one';
                loopNoneBtn.classList.remove('active');
                loopOneBtn.classList.add('active');
                loopAllBtn.classList.remove('active');
                audioPlayer.loop = true;
            });

            loopAllBtn.addEventListener('click', function() {
                loopMode = 'all';
                loopNoneBtn.classList.remove('active');
                loopOneBtn.classList.remove('active');
                loopAllBtn.classList.add('active');
                audioPlayer.loop = false;
            });

            // Initialize the player
            initializePlaylist();
            loadTrack(0);
        });
    </script>
</body>
</html>
